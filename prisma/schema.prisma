// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Admin {
  id       Int    @id @default(autoincrement()) // @id is primary key
  username String @db.VarChar(50)
  email    String @unique @db.VarChar(50)
  password String @db.VarChar(100)
}

model Ruang_kelas {
  id_ruang_kelas Int     @id @default(autoincrement()) // @id is primary key
  nomor_ruangan  Int
  kapasitas      Int
  tersedia       Boolean
  Kelas          Kelas[]

  @@unique([nomor_ruangan])
  @@map("ruang_kelas")
}

model Kelas {
  id_kelas          Int    @id @default(autoincrement())
  nomor_ruang_kelas Int
  kelas             String @db.VarChar(30)

  ruang_kelas Ruang_kelas @relation(fields: [nomor_ruang_kelas], references: [nomor_ruangan])
  murid       Murid[]
  Jadwal      Jadwal[]
  Guru        Guru[]

  @@map("kelas")
}

model Guru {
  id_guru  Int    @id @default(autoincrement()) // @id is primary key
  username String @db.VarChar(50)
  email    String @unique @db.VarChar(50)
  password String @db.VarChar(100)
  id_kelas Int?

  kelas  Kelas?   @relation(fields: [id_kelas], references: [id_kelas])
  Jadwal Jadwal[]
}

model Pelajaran {
  id_pelajara Int      @id @default(autoincrement()) // @id is primary key
  pelajaran   String   @db.VarChar(50)
  Jadwal      Jadwal[]

  @@map("pelajaran")
}

model Murid {
  id_murid Int    @id @default(autoincrement()) // @id is primary key
  username String @db.VarChar(50)
  email    String @unique @db.VarChar(50)
  password String @db.VarChar(100)
  id_kelas Int?

  kelas           Kelas?            @relation(fields: [id_kelas], references: [id_kelas])
  Kehadiran_murid Kehadiran_murid[]

  @@map("murid")
}

model Jadwal {
  id           Int     @id @default(autoincrement())
  id_pelajaran Int
  id_guru      Int
  id_kelas     Int
  hari         Int // 0-6
  mulai        Json // {hour:1,minute:1}
  berakhir     Json // {hour:24,minute:59}
  status       Boolean @default(false) // false sedang berlangsung

  pelajaran Pelajaran @relation(fields: [id_pelajaran], references: [id_pelajara])
  guru      Guru      @relation(fields: [id_guru], references: [id_guru])
  kelas     Kelas     @relation(fields: [id_kelas], references: [id_kelas])

  Kehadiran_murid Kehadiran_murid[]
  Kehadiran_guru  Kehadiran_guru[]
}

model Kehadiran_murid {
  id         Int        @id @default(autoincrement())
  id_jadwal  Int
  tanggal    DateTime
  id_murid   Int
  keterangan Keterangan

  jadwal Jadwal @relation(fields: [id_jadwal], references: [id])
  murid  Murid  @relation(fields: [id_murid], references: [id_murid])
}

model Kehadiran_guru {
  id        Int      @id @default(autoincrement())
  id_jadwal Int
  id_guru   Int
  tanggal   DateTime

  jadwal Jadwal @relation(fields: [id_jadwal], references: [id])
}

enum Keterangan {
  absen
  ijin
  hadir
}
